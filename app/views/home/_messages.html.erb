<%=turbo_stream_from "messages_stream" %>
<%=turbo_frame_tag "messages_#{conversation.id}" do %>
<div class='bg-[#1f2c32] p-4 flex flex-row justify-between'>
  <div class='flex flex-row items-center justify-center'>
    <div class='w-12 h-12 rounded-full bg-sky-200 justify-center items-center flex mr-4'></div>

    <div class='flex flex-col'>
      <div class='text-white'><%=user_in_message(conversation).user.username%></div>
      <div class='text-[#aebac1] text-sm flex items-center'>
        Visto por Ãºltimo <%=l user_in_message(conversation).created_at, format: :short%>
      </div>
    </div>
  </div>

  <div class='text-right items-center flex justify-between'>
    <i class="material-icons text-[#aebac1] mr-4">search</i>
    <i class="material-icons text-[#aebac1]">more_vert</i>
  </div>
</div>

<div class='h-screen overflow-y-auto'>
  <div class='w-full px-40 sm:px-4'>
  <%conversation.messages.each do |message| %>
    <%= render partial: 'messages/message', locals: {message: message, current_user: current_user} %>
  <% end %>
  </div>
</div>
<% end %>
<div class='bg-[#1f2c32] p-4 flex flex-row justify-start sticky bottom-0 w-full items-center'>
  <i class="material-icons text-[#aebac1]">add</i>

  <div class='w-full'>
    <div class='p-1 flex flex-row items-center justify-center'>
      <div class='bg-[#2b3942] rounded-md flex flex-row items-center w-full'>
        <i class="material-icons text-[#aebac1] mx-4">mood</i>
        <%=turbo_frame_tag "form_message_#{conversation.id}_#{current_user.id}", class: 'w-full' do %>
          <%=render partial: 'messages/form', locals: {conversation_id: conversation.id} %>
        <% end %>
      </div>
    </div>
  </div>
  <i class="material-icons text-[#aebac1] ml-2">mic</i>
</div>